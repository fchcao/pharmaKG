#===========================================================
# Neo4j 配置文件 - AutoDL 专用版本
# 适用于 AutoDL 云服务环境（不能使用Docker嵌套）
#===========================================================

#***************************************************************
# 数据库配置
#**************************************************************

# 数据库名称
dbms.default_database=graph.db

# 数据库模式
dbms.mode=SINGLE

# 允许升级
dbms.allow_upgrade=true

#***************************************************************
# 网络配置
#**************************************************************

# HTTP 连接器
dbms.connector.http.enabled=true
dbms.connector.http.listen_address=0.0.0.0:7474
dbms.connector.http.advertised_address=:7474

# HTTPS 连接器（可选，根据需要启用）
dbms.connector.https.enabled=false
# dbms.connector.https.listen_address=0.0.0.0:7473
# dbms.connector.https.advertised_address=:7473

# Bolt 连接器
dbms.connector.bolt.enabled=true
dbms.connector.bolt.listen_address=0.0.0.0:7687
dbms.connector.bolt.advertised_address=:7687

#***************************************************************
# 内存配置 (根据AutoDL实例规格调整)
#*************************************************************

# 堆内存配置（根据实例可用内存调整）
dbms.memory.heap.initial_size=2G
dbms.memory.heap.max_size=4G

# 页缓存配置
dbms.memory.pagecache.size=2G

# 全局内存配置
dbms.memory.transaction.global_max_size=1G

# 事务内存配置
dbms.memory.transaction.max_size=1G

#***************************************************************
# 认证和授权
#**************************************************************

# 启用认证
dbms.security.auth_enabled=true

# 允许特定操作
dbms.security.procedures.unrestricted=apoc.*
dbms.security.procedures.allowlist=apoc.*

#***************************************************************
# 日志配置
#**************************************************************

# 日志级别
dbms.logs.debug.level=INFO

# 查询日志
dbms.logs.query.enabled=true
dbms.logs.query.threshold=1000
dbms.logs.query.parameter_logging_enabled=true

# 安全日志
dbms.logs.security.enabled=true

# GC日志
dbms.logs.gc.enabled=true
dbms.logs.gc.rotation.keep_number=5
dbms.logs.gc.rotation.size=20M

#***************************************************************
# 数据导入配置
#**************************************************************

# 允许从文件URL导入
dbms.security.procedures.unrestricted=apoc.load.*

# 允许从CSV导入
dbms.security.allow_csv_import_from_file_urls=true

# 导入缓冲区大小
dbms.transaction.import.buffer.size=100M

#***************************************************************
# Cypher 配置
#**************************************************************

# Cypher 重用计划
dbms.cypher.min_replan_interval=30s

# Cypher 规划器
dbms.cypher.planner=IDP

# 查询超时
dbms.transaction.timeout=60s

# 查询最大内存
dbms.query_memory_allocation.threshold=1000

#***************************************************************
# 监控配置
#*************************************************************

# 统计信息
dbms.stats_enabled=true

# 统计更新频率
dbms.stats_update_frequency=30s

# 连接器线程池大小
dbms.connector.bolt.thread_pool_max_size=400
dbms.connector.bolt.thread_pool_min_size=5

#***************************************************************
# 性能优化
#*************************************************************

# 约束创建
dbms.schema.constraint=compute

#***************************************************************
# 其他配置
#***************************************************************

# 时区
dbms.timezone.system=Asia/Shanghai

# 时态数据支持
dbms.temporal.timezone=Asia/Shanghai

#***************************************************************
# AutoDL 环境特定配置
#***************************************************************

# 数据目录（使用autodl-tmp路径）
dbms.directories.data=/root/autodl-tmp/pj-pharmaKG/neo4j/data
dbms.directories.logs=/root/autodl-tmp/pj-pharmaKG/neo4j/logs

# 事务日志目录
dbms.directories.tx=log/transaction-log-0

# 备份目录
dbms.backup.destination=/root/autodl-tmp/pj-pharmaKG/backup
